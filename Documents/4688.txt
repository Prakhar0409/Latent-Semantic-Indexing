Windows Genuine Advantage
Windows Genuine Advantage (WGA) is an anti-piracy system created by Microsoft that enforces Microsoft Windows online validation of the licencing of several recent Microsoft operating systems when accessing several Microsoft Windows services, such as Windows Update, and downloading Windows components from the Microsoft Download Center. Specifically, WGA covers Windows XP, Windows Vista and current testing versions of Windows 7. It does not cover Windows 2000, Windows Server 2003 or the Windows 9x family.
It also advertises Service Pack 2 for Windows XP, which requires manual intervention to disable. Previously voluntary, it became mandatory for use of these services in July 2005.
Despite its name it does not directly evaluate the integrity or security of any computer.[1][2]

The WGA validation process validates the present installation of Windows and its license key against the hardware involved and determines if the Software was licensed from Microsoft. It is accessible by either a stand-alone program, or as an ActiveX control within Internet Explorer, the latter of which is relevant to any attempt to access Microsoft updates via its browser. It includes the following steps:
If the software decides the instance of Windows does not have a valid license, WGA displays a specific notice to the user and prevents non-critical updates from being downloaded from Microsoft.
The ActiveX control is downloaded on the first validation and when a new version is available, but the validation itself can be performed any time the user connects to a Microsoft website to update.


When a user installs Windows Genuine Advantage, an Internet Explorer add-on is installed labeled "Windows Genuine Advantage". In early releases the tool could be readily disabled with the IE Add-on Management feature. A Windows Group Policy was added by later updates, causing this option to be unavailable by default, but still accessible if the policy were removed. As of July 2006, the latest update blocks management by other means.
A plugin also exists for Firefox. To remove the plugin, delete npLegitCheckPlugin.dll from the Mozilla Firefox/plugins/ folder.
The program uses either a stand-alone program to generate a key or an ActiveX control to discover whether the license key is valid; either way an Internet connection is required. If WGA determines that a user's copy of Windows is unauthorized but was installed from seemingly-legitimate media (i.e., the CD and holographic emblem present on real copies of Windows seems genuine), then Microsoft will supply the user with a new CD. Microsoft also offers discounts to people who want to purchase a legitimate copy of Windows but do not have a valid CD. Microsoft has indicated that they will continue to deliver critical security updates through their Automatic Updates service as well as via the Microsoft Download Center, so that all systems, including those that fail to pass validation, will still continue to receive critical security updates.
The company has made installation of Windows Genuine Advantage a requirement for use of the Windows Update website (and its close cousin Microsoft Update), in part to be sure that customers who use support resources of the company are aware when their software is unlicensed. According to Microsoft themselves, it is legal to run Microsoft Windows without Windows Genuine Advantage[citation needed]. However, since non-critical Windows updates are not presented by Automatic Updates, installation of WGA is required for installation of such non-critical updates, which are only available through Windows Update or the Microsoft Download Center.

Beginning April 25, 2006, Microsoft began distributing Windows Genuine Advantage Notifications[3] as "critical update" KB905474 to Windows users. Users with pirated copies were exposed to alerts[4] at startup, login, and during use of the Windows OS, stating that they do not have a genuine copy of Windows. Users with legitimate copies are not supposed to see the alerts (although some do anyway[5]). On May 23, 2006, Microsoft updated the program, closing some forms of circumvention, but reportedly not all.[6] It was updated again on May 30, June 6 and June 27, 2006, though some forms of circumvention are still usable. The latest versions do not roll out worldwide at the same time: the dates given are the earliest dates on which the versions appeared, so the actual version being offered in some places will be an earlier version than the latest release. It is still possible to opt out of receiving this update using the "do not show" option at the Windows Update site. In addition to these notifications, Windows Genuine Advantage will also notify users with the message "This version of Windows XP is no longer secure" if users on an XP Operating System are not using Service Pack 3, and it will provide a link to help users to upgrade their systems to the new service pack.
The version of Windows Genuine Advantage Notifications released November 29, 2006 had a changed install process to inform the user of what the program does, and can also be set to automatically update to newer versions of Windows Genuine Advantage Notifications. It also informs users that may have a non-genuine version of Windows why their Windows version isn't being reported as genuine. However, unlike previous releases, it is currently only automatically delivered to Windows machines that are using four widely-distributed product keys. It will be distributed to all other machines in the coming weeks.[7]
The latest update (version 1.9.0040.0) was released on March 24, 2009.

Microsoft includes the Windows Genuine Advantage Validation Library in several products like Windows Defender, Microsoft Private Folder and Windows Media Player 11 to validate about the Windows installation. Internet Explorer 7 no longer requires the user to pass a Windows Genuine Advantage test in order to download or install the software. Older versions, however, did.
Microsoft has also launched the Office Genuine Advantage program, which validates installations of Microsoft Office.

In September 2005, Microsoft filed lawsuits against a number of companies that sold unauthorized copies of software based on leads from customers who learned they had counterfeit software via the Windows Genuine Advantage program.[8]
On November 16, 2005, Microsoft released a standard Netscape WGA plug-in to complete the Windows validation process from Mozilla Firefox and other Gecko-based browsers (including Netscape) - although it does not use the Firefox extensions system, and thus is not supported by the latest version of the browser. This has garnered more criticism, since it still does not work in other NPAPI supported browsers such as Opera. Another workaround was released on December 25, 2005 to bypass WGA authentication by using a valid hash generated by a remote system. Microsoft responded with a cease and desist letter to the website host, and the workaround was taken down on January 6, 2006. Many people continue to validate on the Microsoft website from a public computer using a genuine copy of Windows, then write down the hash and continue to use it at home or work. As of July 2006, Microsoft has not devised a way to prevent this method of circumvention. On May 4, 2006 Microsoft announced lawsuits for allegedly distributing unauthorized copies of Windows against eDirectSoftware of Montana, and Chicago-area resellers Nathan Ballog and Easy Computers.[9]
Various workarounds to get past WGA authentication have been released on the Internet. Before Microsoft issued official instructions[10] on removing the WGA Notifier (a desktop application which resides in the system tray and periodically displays messages, reminding users to authenticate their operating system), users simply had to remove 2 files in order to get rid of the software from their system (four files: one executable and one dynamic link library in C:\Windows\system32\ and their exact copies in C:\Windows\system32\dllcache\; only an administrator can rename/delete these files).
In September 2006, Microsoft dropped various required validations on programs such as ActiveSync.
Recently it has been found that it is possible to validate with WGA when running Linux (see below).

Some personal firewalls, though not one embedded in Windows, may alert on the method by which wgatray.exe is started, in the case of Outpost firewall, it is identified as a "hidden process". The wgatray.exe process itself can be firewall blocked, without apparent problems.
A tool has been released by a firewall vendor to prevent WGA Notifications transmitting information from ones PC.[11]

Windows Genuine Advantage checks the following components:[12][13]

On October 20, 2008, many users of Windows XP in China received a black desktop, as Microsoft introduced its WGA system for Chinese language systems,[14][15][16] in an effort to combat piracy, which is extremely high in China. This version of WGA is of a more hostile approach as compared to previous forms, as it provides a hindrance to users and trespasses on usability. Since the majority of users in China run on a pirated copy of Windows, many users have experienced what is described as a "black screen syndrome", where the operating system changes the desktop background to a black screen every 60 minutes, as well as displaying constant warning messages.[17][18] Some users have even reported the disabling of Office programs such as Microsoft Word, PowerPoint and Outlook.[19]
According to various polls carried out by Chinese portals such as Sohu.com, QQ.com, 21cn.com, and many others, a large number (over 60% of those surveyed) of Chinese Internet users are hostile to Microsoft Windows Genuine Advantage (WGA) and Office Genuine Advantage (OGA).[20]


Even if WGA does not really make the program unusable, no updates except critical ones can be downloaded from Microsoft. Rather than just disallowing updating, Windows Vista originally ran in reduced-functionality mode if found by WGA to be compromised[21] if a product has not been considered genuine which has made some people compare WGA to time bomb software.[22][23][24] Windows Vista SP1 has removed this behavior and reverted back to the nag-only methods of Windows XP.[25]

The notification tool has been accused of spyware-like behavior, "phoning home" on a daily basis.[26][27][28] Microsoft subsequently admitted the behaviour, but denied that it amounted to spyware.[29][30] Following pressure, Microsoft announced that in future the tool would only phone home once every two weeks, instead of every day.[31] Microsoft has also provided removal instructions for the pilot version of WGA.[10]
Despite this, Microsoft is currently being sued under anti-spyware statutes over WGA's non-disclosed "phone home" behaviour.[32] The outcome of the lawsuit has not been determined.

The WGA program can produce false positives (incorrectly identifying a genuine copy of Windows as "not genuine"). This can happen for any number of reasons. Microsoft has established a forum to help users encountering problems.[33] Recently,[when?] a "Not Sure" section was added to the program, in case of an incorrect reading.
According to an editorial on the arstechnica.com technology website, WGA reported around 22% of 500 million Windows computers as failing the test; of these less than 0.5% were due to pirate software, with the balance (over 20%, or 90% of all positives) related to non piracy issues. Microsoft "refused to comment on the rate of pure false positives" beyond saying it was "under 1%" (or as stated, at most around 5 million users affected).[34]

On the other hand, on June 18, 2007, news surfaced that it is possible to positively validate as a "Genuine Microsoft Product" user (and â€“ as a result â€“ be able to download certain software from Microsoft's official website) using Internet Explorer with ies4Linux and Wine, running on Linux,[1] without even having a Windows-family system installed.

From the first moment that WGA was released, it had a fatal system flaw that allowed a typical user to remove the program without uninstalling its root key, causing Windows to think that the software is installed despite the fact that no "nagging" process or RAM usage occurs.[citation needed] This flaw has not yet been fixed.
On October 5, 2006, a WGA failure occurred, incorrectly flagging some systems as being non-genuine.[35]
On August 25, 2007, the Microsoft WGA servers suffered an outage, resulting in many legitimate copies of Windows XP and Vista being marked as counterfeit.[36] The issue was solved about twelve hours later. According to Microsoft, "fewer than 12,000 systems were affected worldwide."[37]
On July 18, 2008, reports of Microsoft's WGA and OGA servers being offline surfaced again. Microsoft later responded that only offline verification was temporarily down.[38]


